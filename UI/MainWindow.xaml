<mah:MetroWindow x:Class="Skriptorium.UI.MainWindow"
        xmlns="http://schemas.microsoft.com/winfx/2006/xaml/presentation"
        xmlns:x="http://schemas.microsoft.com/winfx/2006/xaml"
        xmlns:mah="clr-namespace:MahApps.Metro.Controls;assembly=MahApps.Metro"
        xmlns:avalon="https://github.com/Dirkster99/AvalonDock"
        xmlns:local="clr-namespace:Skriptorium.UI"
        Title="Skriptorium" TitleCharacterCasing="Normal"
        Height="750" Width="1000" WindowStartupLocation="CenterScreen"
        Icon="pack://application:,,,/Skriptorium.ico"
        Background="{DynamicResource MahApps.Brushes.Window.Background}"
        Foreground="{DynamicResource MahApps.Brushes.Text}">

    <DockPanel>
        <!-- Menüleiste -->
        <Menu DockPanel.Dock="Top" BorderBrush="Gray" FontSize="12" BorderThickness="0,1,0,1">
            <MenuItem Header="Skriptorium">
                <MenuItem Header="{DynamicResource AboutSkriptorium}" InputGestureText="{DynamicResource CtrlI}" Click="MenuSkriptoriumUeber_Click">
                    <MenuItem.Icon>
                        <TextBlock FontFamily="Segoe MDL2 Assets" Text="&#xE946;" FontSize="14"/>
                    </MenuItem.Icon>
                </MenuItem>
                <MenuItem Header="{DynamicResource Settings}" InputGestureText="{DynamicResource CtrlComma}" Click="MenuSkriptoriumEinstellungen_Click">
                    <MenuItem.Icon>
                        <TextBlock FontFamily="Segoe MDL2 Assets" Text="&#xE713;" FontSize="14"/>
                    </MenuItem.Icon>
                </MenuItem>
                <Separator/>
                <MenuItem Header="{DynamicResource Exit}" InputGestureText="Alt + F4" Click="MenuSkriptoriumBeenden_Click">
                    <MenuItem.Icon>
                        <TextBlock FontFamily="Segoe MDL2 Assets" Text="&#xE8BB;" FontSize="12"/>
                    </MenuItem.Icon>
                </MenuItem>
            </MenuItem>

            <MenuItem Header="{DynamicResource File}">
                <MenuItem Header="{DynamicResource New}" InputGestureText="{DynamicResource CtrlN}" Click="MenuDateiNeuesSkript_Click">
                    <MenuItem.Icon>
                        <TextBlock FontFamily="Segoe MDL2 Assets" Text="&#xE710;" FontSize="14"/>
                    </MenuItem.Icon>
                </MenuItem>
                <MenuItem Header="{DynamicResource Open}" InputGestureText="{DynamicResource CtrlO}" Click="MenuDateiÖffnen_Click">
                    <MenuItem.Icon>
                        <TextBlock FontFamily="Segoe MDL2 Assets" Text="&#xED25;" FontSize="17"/>
                    </MenuItem.Icon>
                </MenuItem>
                <MenuItem x:Name="MenuDateiZuletztGeoeffnet" Header="{DynamicResource LastOpened}">
                    <MenuItem.Icon>
                        <TextBlock FontFamily="Segoe MDL2 Assets" Text="&#xE81C;" FontSize="15"/>
                    </MenuItem.Icon>
                </MenuItem>
                <Separator/>
                <MenuItem Header="{DynamicResource Save}" InputGestureText="{DynamicResource CtrlS}" Click="MenuDateiSpeichern_Click">
                    <MenuItem.Icon>
                        <TextBlock FontFamily="Segoe MDL2 Assets" Text="&#xE105;" FontSize="15"/>
                    </MenuItem.Icon>
                </MenuItem>
                <MenuItem Header="{DynamicResource SaveAs}" InputGestureText="{DynamicResource CtrlShiftS}" Click="MenuDateiSpeichernUnter_Click">
                    <MenuItem.Icon>
                        <TextBlock FontFamily="Segoe MDL2 Assets" Text="&#xE792;" FontSize="17"/>
                    </MenuItem.Icon>
                </MenuItem>
                <MenuItem Header="{DynamicResource SaveAll}" InputGestureText="{DynamicResource CtrlAltS}" Click="MenuDateiAllesSpeichern_Click">
                    <MenuItem.Icon>
                        <TextBlock FontFamily="Segoe MDL2 Assets" Text="&#xEA35;" FontSize="15"/>
                    </MenuItem.Icon>
                </MenuItem>
                <MenuItem Header="{DynamicResource Close}" InputGestureText="{DynamicResource CtrlW}" Click="MenuDateiSchließen_Click">
                    <MenuItem.Icon>
                        <TextBlock FontFamily="Segoe MDL2 Assets" Text="&#xE8BB;" FontSize="12"/>
                    </MenuItem.Icon>
                </MenuItem>
            </MenuItem>

            <MenuItem Header="{DynamicResource Edit}">
                <MenuItem Header="{DynamicResource Undo}" InputGestureText="{DynamicResource CtrlZ}" Click="MenuBearbeitenRueckgaengig_Click">
                    <MenuItem.Icon>
                        <TextBlock FontFamily="Segoe MDL2 Assets" Text="&#xE7A7;" FontSize="15"/>
                    </MenuItem.Icon>
                </MenuItem>
                <MenuItem Header="{DynamicResource Redo}" InputGestureText="{DynamicResource CtrlY}" Click="MenuBearbeitenWiederholen_Click">
                    <MenuItem.Icon>
                        <TextBlock FontFamily="Segoe MDL2 Assets" Text="&#xE7A6;" FontSize="15"/>
                    </MenuItem.Icon>
                </MenuItem>
                <Separator/>
                <MenuItem Header="{DynamicResource Cut}" InputGestureText="{DynamicResource CtrlX}" Click="MenuBearbeitenAusschneiden_Click">
                    <MenuItem.Icon>
                        <TextBlock FontFamily="Segoe MDL2 Assets" Text="&#xE8C6;" FontSize="15"/>
                    </MenuItem.Icon>
                </MenuItem>
                <MenuItem Header="{DynamicResource Copy}" InputGestureText="{DynamicResource CtrlC}" Click="MenuBearbeitenKopieren_Click">
                    <MenuItem.Icon>
                        <TextBlock FontFamily="Segoe MDL2 Assets" Text="&#xE8C8;" FontSize="15"/>
                    </MenuItem.Icon>
                </MenuItem>
                <MenuItem Header="{DynamicResource Paste}" InputGestureText="{DynamicResource CtrlV}" Click="MenuBearbeitenEinfuegen_Click">
                    <MenuItem.Icon>
                        <TextBlock FontFamily="Segoe MDL2 Assets" Text="&#xE77F;" FontSize="15"/>
                    </MenuItem.Icon>
                </MenuItem>
                <Separator/>
                <MenuItem Header="{DynamicResource Duplicate}" InputGestureText="{DynamicResource CtrlD}" Click="MenuBearbeitenDuplizieren_Click">
                    <MenuItem.Icon>
                        <TextBlock FontFamily="Segoe MDL2 Assets" Text="&#xE8C8;" FontSize="15"/>
                    </MenuItem.Icon>
                </MenuItem>
                <MenuItem Header="{DynamicResource SelectAll}" InputGestureText="{DynamicResource CtrlA}" Click="MenuBearbeitenAllesAuswaehlen_Click"/>
            </MenuItem>

            <MenuItem Header="{DynamicResource Search}">
                <MenuItem Header="{DynamicResource SearchAndReplace}" InputGestureText="{DynamicResource CtrlF}" Click="FindInEditor_Click">
                    <MenuItem.Icon>
                        <TextBlock FontFamily="Segoe MDL2 Assets" Text="&#xE721;" FontSize="15"/>
                    </MenuItem.Icon>
                </MenuItem>
            </MenuItem>

            <MenuItem Header="{DynamicResource Bookmarks}">
                <MenuItem Header="{DynamicResource AddAndRemove}" InputGestureText="F2" Click="MenuLesezeichenUmschalten_Click">
                    <MenuItem.Icon>
                        <TextBlock FontFamily="Segoe MDL2 Assets" Text="&#xE840;" FontSize="15"/>
                    </MenuItem.Icon>
                </MenuItem>
                <MenuItem Header="{DynamicResource Next}" InputGestureText="{DynamicResource CtrlF2}" Click="MenuLesezeichenNaechstes_Click">
                    <MenuItem.Icon>
                        <TextBlock FontFamily="Segoe MDL2 Assets" Text="&#xE72B;" FontSize="13"/>
                    </MenuItem.Icon>
                </MenuItem>
                <MenuItem Header="{DynamicResource Previous}" InputGestureText="{DynamicResource CtrlShiftF2}" Click="MenuLesezeichenVorheriges_Click">
                    <MenuItem.Icon>
                        <TextBlock FontFamily="Segoe MDL2 Assets" Text="&#xE72A;" FontSize="13"/>
                    </MenuItem.Icon>
                </MenuItem>
                <Separator/>
                <MenuItem Header="{DynamicResource RemoveAll}" InputGestureText="{DynamicResource CtrlAltF2}" Click="MenuLesezeichenAlleLoeschen_Click">
                    <MenuItem.Icon>
                        <TextBlock FontFamily="Segoe MDL2 Assets" Text="&#xE77A;" FontSize="15"/>
                    </MenuItem.Icon>
                </MenuItem>
            </MenuItem>

            <MenuItem Header="{DynamicResource Tools}">
                <MenuItem Header="{DynamicResource ToggleSyntax-Highlighting}" InputGestureText="{DynamicResource CtrlH}" Click="SyntaxHighlightingUmschalten_Click">
                    <MenuItem.Icon>
                        <TextBlock FontFamily="Segoe MDL2 Assets" Text="&#xE7E6;" FontSize="14"/>
                    </MenuItem.Icon>
                </MenuItem>
                <MenuItem Header="{DynamicResource ToggleAutocompletion}" InputGestureText="{DynamicResource CtrlShiftA}" Click="ToggleAutocompletion_Click">
                    <MenuItem.Icon>
                        <TextBlock FontFamily="Segoe MDL2 Assets" Text="&#xE932;" FontSize="14"/>
                    </MenuItem.Icon>
                </MenuItem>
                <MenuItem Header="{DynamicResource Comments}">
                    <MenuItem.Icon>
                        <TextBlock FontFamily="Segoe MDL2 Assets" Text="&#xED63;" FontSize="14"/>
                    </MenuItem.Icon>
                    <MenuItem Header="{DynamicResource BlockComment}" InputGestureText="{DynamicResource CtrlK}" Click="Blockkommentar_Click"/>
                    <MenuItem Header="{DynamicResource SmallCommentField}" InputGestureText="{DynamicResource CtrlShiftK}" Click="KleinesKommentarfeld_Click"/>
                    <MenuItem Header="{DynamicResource MiddleCommentField}" InputGestureText="{DynamicResource CtrlAltK}" Click="MittleresKommentarfeld_Click"/>
                    <MenuItem Header="{DynamicResource BigCommentField}" InputGestureText="{DynamicResource CtrlShiftAltK}" Click="GroßesKommentarfeld_Click"/>
                </MenuItem>
                <MenuItem Header="{DynamicResource CollapseAndExpandFoldings}" InputGestureText="{DynamicResource CtrlM}" Click="ToggleFoldings_Click">
                    <MenuItem.Icon>
                        <TextBlock FontFamily="Segoe MDL2 Assets" Text="&#xF168;" FontSize="14"/>
                    </MenuItem.Icon>
                </MenuItem>
                <MenuItem Header="{DynamicResource IndentText}" InputGestureText="{DynamicResource CtrlE}" Click="MenuCodeFormatieren_Click">
                    <MenuItem.Icon>
                        <TextBlock FontFamily="Segoe MDL2 Assets" Text="&#xE71D;" FontSize="14"/>
                    </MenuItem.Icon>
                </MenuItem>
                <MenuItem Header="{DynamicResource CheckSyntax}" InputGestureText="F5" Click="SyntaxCheckButton_Click">
                    <MenuItem.Icon>
                        <TextBlock FontFamily="Segoe MDL2 Assets" Text="&#xE768;" FontSize="14"/>
                    </MenuItem.Icon>
                </MenuItem>
                <Separator/>
                <MenuItem Header="{DynamicResource FileExplorer}" InputGestureText="{DynamicResource CtrlShiftE}" Click="MenuToolsFileExplorer_Click">
                    <MenuItem.Icon>
                        <TextBlock FontFamily="Segoe MDL2 Assets" Text="&#xEC50;" FontSize="14"/>
                    </MenuItem.Icon>
                </MenuItem>
                <MenuItem Header="{DynamicResource SearchExplorer}" InputGestureText="{DynamicResource CtrlShiftF}" Click="MenuToolsSearchExplorer_Click">
                    <MenuItem.Icon>
                        <TextBlock FontFamily="Segoe MDL2 Assets" Text="&#xF8A5;" FontSize="15"/>
                    </MenuItem.Icon>
                </MenuItem>
                <MenuItem Header="{DynamicResource CodeStructure}" InputGestureText="{DynamicResource CtrlShiftC}" Click="MenuToolsCodeStructure_Click">
                    <MenuItem.Icon>
                        <TextBlock FontFamily="Segoe MDL2 Assets" Text="&#xE943;" FontSize="14"/>
                    </MenuItem.Icon>
                </MenuItem>
                <MenuItem Header="{DynamicResource NPCGenerator}" InputGestureText="{DynamicResource CtrlG}" Click="MenuNPCGenerator_Click">
                    <MenuItem.Icon>
                        <TextBlock FontFamily="Segoe MDL2 Assets" Text="&#xE77B;" FontSize="14"/>
                    </MenuItem.Icon>
                </MenuItem>
                <MenuItem Header="{DynamicResource OrcGenerator}" InputGestureText="{DynamicResource CtrlShiftG}" Click="MenuOrcGenerator_Click">
                    <MenuItem.Icon>
                        <TextBlock FontFamily="Segoe MDL2 Assets" Text="&#xE8D4;" FontSize="14"/>
                    </MenuItem.Icon>
                </MenuItem>
                <MenuItem Header="{DynamicResource DialogGenerator}" InputGestureText="{DynamicResource CtrlAltG}" Click="MenuDialogGenerator_Click">
                    <MenuItem.Icon>
                        <TextBlock FontFamily="Segoe MDL2 Assets" Text="&#xEBDB;" FontSize="14"/>
                    </MenuItem.Icon>
                </MenuItem>
            </MenuItem>
        </Menu>

        <!-- Toolbar -->
        <ToolBar DockPanel.Dock="Top" ToolBarTray.IsLocked="True" Height="28" Background="Transparent">
            <Button ToolTip="{DynamicResource New}" Click="MenuDateiNeuesSkript_Click">
                <TextBlock FontFamily="Segoe MDL2 Assets" Text="&#xE710;" FontSize="12"/>
            </Button>
            <Button ToolTip="{DynamicResource Open}" Click="MenuDateiÖffnen_Click">
                <TextBlock FontFamily="Segoe MDL2 Assets" Text="&#xED25;" FontSize="12"/>
            </Button>
            <Button ToolTip="{DynamicResource Save}" Click="MenuDateiSpeichern_Click">
                <TextBlock FontFamily="Segoe MDL2 Assets" Text="&#xE105;" FontSize="12"/>
            </Button>
            <Button ToolTip="{DynamicResource SaveAll}" Click="MenuDateiAllesSpeichern_Click">
                <TextBlock FontFamily="Segoe MDL2 Assets" Text="&#xEA35;" FontSize="12"/>
            </Button>
            <Separator />
            <Button ToolTip="{DynamicResource Undo}" Click="MenuBearbeitenRueckgaengig_Click">
                <TextBlock FontFamily="Segoe MDL2 Assets" Text="&#xE7A7;" FontSize="12"/>
            </Button>
            <Button ToolTip="{DynamicResource Redo}" Click="MenuBearbeitenWiederholen_Click">
                <TextBlock FontFamily="Segoe MDL2 Assets" Text="&#xE7A6;" FontSize="12"/>
            </Button>
            <Separator />
            <Button ToolTip="{DynamicResource SearchAndReplace}" Click="FindInEditor_Click">
                <TextBlock FontFamily="Segoe MDL2 Assets" Text="&#xE721;" FontSize="12"/>
            </Button>
            <Button ToolTip="{DynamicResource Comments}" Click="KommentareButton_Click">
                <TextBlock FontFamily="Segoe MDL2 Assets" Text="&#xED63;" FontSize="12"/>
                <Button.ContextMenu>
                    <ContextMenu>
                        <MenuItem Header="{DynamicResource BlockComment}" InputGestureText="Strg + K" Click="Blockkommentar_Click" FontSize="12"/>
                        <MenuItem Header="{DynamicResource SmallCommentField}" InputGestureText="Strg + Shift + K" Click="KleinesKommentarfeld_Click" FontSize="12"/>
                        <MenuItem Header="{DynamicResource MiddleCommentField}" InputGestureText="Strg + Alt + K" Click="MittleresKommentarfeld_Click" FontSize="12"/>
                        <MenuItem Header="{DynamicResource BigCommentField}" InputGestureText="Strg + Shift + Alt + K" Click="GroßesKommentarfeld_Click" FontSize="12"/>
                    </ContextMenu>
                </Button.ContextMenu>
            </Button>
            <Button ToolTip="{DynamicResource CollapseAndExpandFoldings}" Click="ToggleFoldings_Click">
                <TextBlock FontFamily="Segoe MDL2 Assets" Text="&#xF168;" FontSize="12"/>
            </Button>
            <Button ToolTip="{DynamicResource IndentText}" Click="MenuCodeFormatieren_Click">
                <TextBlock FontFamily="Segoe MDL2 Assets" Text="&#xE71D;" FontSize="12"/>
            </Button>
            <Separator />
            <Button ToolTip="{DynamicResource FileExplorer}" Click="MenuToolsFileExplorer_Click">
                <TextBlock FontFamily="Segoe MDL2 Assets" Text="&#xEC50;" FontSize="12"/>
            </Button>
            <Button ToolTip="{DynamicResource SearchExplorer}" Click="MenuToolsSearchExplorer_Click">
                <TextBlock FontFamily="Segoe MDL2 Assets" Text="&#xF8A5;" FontSize="12"/>
            </Button>
            <Button ToolTip="{DynamicResource CodeStructure}" Click="MenuToolsCodeStructure_Click">
                <TextBlock FontFamily="Segoe MDL2 Assets" Text="&#xE943;" FontSize="12"/>
            </Button>
            <Button ToolTip="{DynamicResource NPCGenerator}" Click="MenuNPCGenerator_Click">
                <TextBlock FontFamily="Segoe MDL2 Assets" Text="&#xE77B;" FontSize="12"/>
            </Button>
            <Button ToolTip="{DynamicResource OrcGenerator}" Click="MenuOrcGenerator_Click">
                <TextBlock FontFamily="Segoe MDL2 Assets" Text="&#xE8D4;" FontSize="12"/>
            </Button>
            <Button ToolTip="{DynamicResource DialogGenerator}" Click="MenuDialogGenerator_Click">
                <TextBlock FontFamily="Segoe MDL2 Assets" Text="&#xEBDB;" FontSize="12"/>
            </Button>
        </ToolBar>

        <!-- Statusleiste unten -->
        <StatusBar DockPanel.Dock="Bottom">
            <StatusBarItem HorizontalAlignment="Left" Margin="0,0,20,0">
                <StackPanel Orientation="Horizontal">
                    <ComboBox Name="ZoomComboBox" Width="70" SelectedIndex="3" SelectionChanged="ZoomComboBox_SelectionChanged">
                        <ComboBoxItem Content="20 %"/>
                        <ComboBoxItem Content="50 %"/>
                        <ComboBoxItem Content="75 %"/>
                        <ComboBoxItem Content="100 %"/>
                        <ComboBoxItem Content="125 %"/>
                        <ComboBoxItem Content="150 %"/>
                        <ComboBoxItem Content="200 %"/>
                        <ComboBoxItem Content="300 %"/>
                        <ComboBoxItem Content="400 %"/>
                    </ComboBox>
                </StackPanel>
            </StatusBarItem>
            <StatusBarItem HorizontalAlignment="Right" Margin="0,0,20,0">
                <StackPanel Orientation="Horizontal">
                    <TextBlock Name="StatusPositionText" Text="Zeile 1, Spalte 1" Margin="0,0,10,0"/>
                    <TextBlock Name="StatusCharCountText" Text="0 Zeichen"/>
                </StackPanel>
            </StatusBarItem>
        </StatusBar>

        <!-- AvalonDock DockingManager -->
        <avalon:DockingManager x:Name="dockingManager"
                AnchorablesSource="{Binding Anchorables}"
                DocumentsSource="{Binding Documents}"
                ActiveContent="{Binding ActiveContent, Mode=TwoWay}"
                DocumentClosing="DockingManager_DocumentClosing"
                DocumentClosed="DockingManager_DocumentClosed">

            <avalon:LayoutRoot>
                <avalon:LayoutPanel Orientation="Horizontal">
                    <avalon:LayoutDocumentPaneGroup>
                        <avalon:LayoutDocumentPane x:Name="documentPane"/>
                    </avalon:LayoutDocumentPaneGroup>
                </avalon:LayoutPanel>
            </avalon:LayoutRoot>
        </avalon:DockingManager>
    </DockPanel>
</mah:MetroWindow>